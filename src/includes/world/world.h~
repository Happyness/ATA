/**
 * Contains structs and prototype functions for modifying the game world.
 *
 * @author Joel Denke      mail@happyness.se
 * @author Marcus Isaksson marcus.is@telia.com
 * @date   12 april 2012
 */

#ifndef _WORLD_H
#define _WORLD_H

#define MIN_PLAYERS 2
#define NO_TEAMS    2
#define NO_PLAYERS  6
#define NO_OBJECTS  100
#define GRAVITY     0.25
#define FRICTION    0.025

enum movement {left, right, up, down};

/**
 * Structure for a "box" in the world.
 * 
 */
struct box {
	int x, y, width, height;
};

/**
 * Structure for a player in the world.
 * 
 */
struct player {
	int id, team, dx, dy, mass;
	struct box box;
};

/**
 * An object. The world contains a number of blocks which is objects.
 */
struct object {
	int id, movable;
	struct box box;
};

/**
 * A world contains maximum 6 players and is built of blocks.
 * Each block is an object.
 * 
 */
struct world {
	struct player players[NO_PLAYERS];
	struct object objects[NO_OBJECTS];
	int noOfObjects;
};

/**
 * Function that test if two boxes intersects or not
 *
 * @author	Joel Denke	mail@happyness.se
 * @param 	a  		Properties of a box a
 * @param 	b 		Properties of a box b
 *
 */
int isCollision(struct box, struct box);

/**
 * Calculate friction and gravity into length in one timestep
 *
 * @author	Joel Denke	mail@happyness.se
 * @param	box       	Properties of a box
 * @param	direction 	Direction you want to go.
 */
int calculateLengthToMove(struct player *, enum movement);

/**
 * Function that test a players movement and
 * moves him if legit.
 *
 *@param testPlayer 	Player you want to move,
 *@param objects 	All objects in the world.
 *@param noOfObjects 	Number of objects in the objects array.
 *@param direction 	Direction you want to go.
 */
void movePlayer(struct player*, struct object *, int, enum movement);
/**
 * A function that test if a player should be falling
 * and moves him if so.
 *
 *@param testPlayer 	Player you want to move,
 *@param objects 	All objects in the world.
 *@param noOfObjects 	Number of objects in the objects array.
 */
void gravity(struct player*, struct object *, int);

#endif